<div class="container-fluid ng-cloak" layout-padding layout="column" ng-cloak>
	<div layout="row">
		<div layout="column" flex="100">
			<div layout="row" class="height100">
				<div layout="column" flex="90" >
					<md-input-container class="md-block md-accent">
					  <label>Search boardgame</label>
					  <input ng-model="query">
					</md-input-container>
				</div>
				<div layout="column" flex="10" layout-align="center center"> 
					<md-menu>
						<md-button class="md-fab md-mini" ng-click="$mdOpenMenu(ev)">
							<i class="icon-sort-amount-desc" aria-label="select list ordering"></i>
						</md-button>
						<md-menu-content width="4">
							<md-menu-item>
								<md-button ng-click="msCtrl.setOrderingField('-name')">
									<i class="icon-sort-alpha-asc" md-colors="{color: 'myTheme-accent'}"></i>
									Alphabetical order
								</md-button>
							</md-menu-item>
							<md-menu-item>
								<md-button ng-click="msCtrl.setOrderingField('lastMatchTime')">
									<i class="icon-clock-o" md-colors="{color: 'myTheme-accent'}"></i>
									Last played
								</md-button>
							</md-menu-item>
						</md-menu-content>
					</md-menu>
				</div>
			</div> 
			<div layout="row" class="height600">
				<div layout="column" flex="100">
					<md-tabs  md-selected="currentTab"
					md-stretch-tabs="always" class="height100perc" >
						
						<md-tab label="Programmed matches">
							<md-content>
								<div layout="row" class="overflowScroll">
									<div layout="column" flex="100">
										<md-list flex ng-show="msCtrl.loaded" ng-init=$scope>
											<md-list-item
												class=" md-3-line animate-repeat whiteBg mrg5b mrg5r shadowed-box"						
												ng-repeat-start="boardgame in (games | filter:{name:query} | filter: msCtrl.timeGreaterThanGame) | orderBy:msCtrl.getOrderingField():true"
												ng-click="msCtrl.setVisible(boardgame.$id)" ng-if="boardgame.hasOwnProperty('matches')">
												<img ng-src="{{boardgame.thumbnail}}" class="md-avatar" alt="match {{boardgame.name}}" />
												<div layout="column">
													<div layout="row">
														<h3> {{boardgame.name}}</h3>
													</div>
												</div>
												<i 
												ng-if="user.profile_details.favourites[boardgame.$id]"
												aria-label="remove favourite"
												class="icon-heart md-secondary" 
												md-colors="{color: 'myTheme-accent'}"
												ng-click="msCtrl.toggleFavourite(boardgame)"></i>
												<i 
												ng-if="!user.profile_details.favourites[boardgame.$id]" 
												aria-label="add favourite"
												class="icon-heart-o md-secondary"  
												md-colors="{color: 'myTheme-accent'}"
												ng-click="msCtrl.toggleFavourite(boardgame)"></i>
											</md-list-item>
											
											<md-list-item 
											ng-if="boardgame.visible"
											class=" md-3-line mrg50l whiteBg mrg5b mrg5r shadowed-box" ng-cloak						
											ng-repeat-end ng-repeat="match in boardgame.matches | orderObjectBy:'-time' | filter: msCtrl.timeGreaterThanMatch"
											ng-href="#/matches/{{match.key}}"
											>

												<img ng-src="{{boardgame.thumbnail}}" class="md-avatar" alt="match {{boardgame.name}}" />
												<div layout="column">
													<div layout="row">
														<h3 ng-if="match.name.length == 0"> Match {{key}}</h3>
														<h3 ng-if="match.name.length > 0">{{match.name}}</h3>
													</div>
													<div layout="row" class="size-14">
														<i>{{match.time | date:"EEEE, MMMM d, y, H:mm in"}} {{match.location}}</i>
													</div>
												</div>
											</md-list-item>
										</md-list>
									</div>
								</div>
							</md-content>
						</md-tab>
						
						<md-tab label="all matches">
							<md-content>
								<div layout="row" class="overflowScroll">
									<div layout="column" flex="100">
										<md-list flex ng-show="msCtrl.loaded" ng-init=$scope>
											<md-list-item
												class=" md-3-line animate-repeat whiteBg mrg5b mrg5r shadowed-box"						
												ng-repeat-start="boardgame in games | filter:{name:query} | orderBy:msCtrl.getOrderingField():true"
												ng-click="msCtrl.setVisible(boardgame.$id)" ng-if="boardgame.hasOwnProperty('matches')">
												<img ng-src="{{boardgame.thumbnail}}" class="md-avatar" alt="match {{boardgame.name}}" />
												<div layout="column">
													<div layout="row">
														<h3> {{boardgame.name}}</h3>
													</div>
													<div layout="row">
														<i>{{boardgame.matches | keylength}} matches</i>
													</div>
												</div>
												<i 
												ng-if="user.profile_details.favourites[boardgame.$id]"
												aria-label="remove favourite"
												class="icon-heart md-secondary" 
												md-colors="{color: 'myTheme-accent'}"
												ng-click="msCtrl.toggleFavourite(boardgame)"></i>
												<i 
												ng-if="!user.profile_details.favourites[boardgame.$id]" 
												aria-label="add favourite"
												class="icon-heart-o md-secondary"  
												md-colors="{color: 'myTheme-accent'}"
												ng-click="msCtrl.toggleFavourite(boardgame)"></i>
											</md-list-item>
											
											<md-list-item 
											ng-if="boardgame.visible"
											class=" md-3-line mrg50l whiteBg mrg5b mrg5r shadowed-box" ng-cloak						
											ng-repeat-end ng-repeat="match in boardgame.matches | orderObjectBy:'-time'"
											ng-href="#/matches/{{match.key}}"
											>

												<img ng-src="{{boardgame.thumbnail}}" class="md-avatar" alt="match {{boardgame.name}}" />
												<div layout="column">
													<div layout="row">
														<h3 ng-if="match.name.length == 0"> Match {{key}}</h3>
														<h3 ng-if="match.name.length > 0">{{match.name}}</h3>
													</div>
													<div layout="row" class="size-14">
														<i>{{match.time | date:"EEEE, MMMM d, y, H:mm in"}} {{match.location}}</i>
													</div>
												</div>
											</md-list-item>
										</md-list>
									</div>
								</div>
							</md-content>
						</md-tab>
					</md-tabs>
				</div>
			</div>
		</div>
	</div>
</div>